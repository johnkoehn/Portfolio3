<html>
<head>
<link rel="stylesheet" type="text/css" href="gameStyle.css">
<script src="https://ajax.googleapis.com/ajax/libs/jquery/1.11.1/jquery.min.js"></script>
</head>

<body>

<div id = 'not-chat'>
	<p>{{Name}} : {{Cash Money}}</p>
	<p>Choose a color to bet on:</p>
	<div id = 'buttons'>
	<input type = 'button' id = 'red' value = '1:2'>
	<input type = 'button' id = 'green' value = '1:15'>
	<input type = 'button' id = 'black' value = '1:2'>
	</br>
	</div>
	
	<p id = 'redBets'>{{Red Bets}}</p>
	<p id = 'greenBets'>{{Green Bets}}</p>
	<p id = 'blackBets'>{{Black Bets}}</p>
	
	<div style='clear:both;'></div>

	
	<svg width="300" height="300">
		<rect id = "colorTest" width="300" height="300" style="fill:#e60000;">
		Sorry, your browser does not support inline SVG.  
	</svg>
	</br></br>
	
	Time to bet:
	<progress value='20' max='20' id='countDownBar'></progress>
	<p id='countDown' style='display:inline'>{{countDown#}}</p>
	</br></br>
	
	Bet Amount:
	<input type='text' value='0' id='bet'>
	<input type='button' value='Bet' id='betButton'>
	
</div>
<div id = 'chat'>

	</br></br>
	<div id='chatbox'></div>
	
	<input name='usermsg' type='text' id='usermessage'>
	<input type='button' id='submit' value='Send'>
	
</div>

</body>
<script>
var cycler = {
	going : false,
	interval : 0,
	counter : 0,
	numCycles : 0,
	winner : 0
}

$('#red').click(function()
{
	var color = $(this).css('background-color');
	$('#betButton').css('background-color', color);
});
$('#green').click(function()
{
	var color = $(this).css('background-color');
	$('#betButton').css('background-color', color);
});
$('#black').click(function()
{
	var color = $(this).css('background-color');
	$('#betButton').css('background-color', color);
});
$('#betButton').click(function()
{
	if(!cycler.going)
	{
		cycler.counter = 0;
		cycler.interval = window.setInterval(changeColor, cycler.counter);
		cycler.winner = Math.floor(Math.random() * 15) + 1;
		cycler.numCycles = cycler.winner + 40;
		cycler.going = true;
	}
	
});
function changeColor()
{
	//set winning color
	if(cycler.counter == cycler.numCycles)
	{
		cycler.going = false;
		clearInterval(cycler.interval);
		if(cycler.winner < 8)
			$('#colorTest').css('fill', '#E60000');
		else if(cycler.winner == 15)
			$('#colorTest').css('fill', 'GREEN');
		else
			$('#colorTest').css('fill', 'BLACK');
		return;
	}
	
	//general case, cycle for a while.
	if($('#colorTest').css('fill') == 'rgb(230, 0, 0)')
	{	
		$('#colorTest').css('fill', 'GREEN');
	}
	else if($('#colorTest').css('fill') == 'rgb(0, 128, 0)')
	{	
		$('#colorTest').css('fill', 'BLACK');
	}
	else if($('#colorTest').css('fill') == 'rgb(0, 0, 0)')
	{	
		$('#colorTest').css('fill', '#e60000');
	}
	else
	{
		console.log('error');
	}
	++cycler.counter;
	clearInterval(cycler.interval);
	cycler.interval = window.setInterval(changeColor, (cycler.counter * 10));
}
</script>
</html>